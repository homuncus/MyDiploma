import{d as b,k as V,r as m,a as k,b as o,c as B,g,q as w,C as D,l as E,y as L,z as v,m as i,e as p,w as x,A as $,F as y,B as z,H as F,n as r,D as f,J as U,E as j}from"./index-9ca6b9fc.js";import"./DayJs-c6e502d2.js";const q=b({__name:"ElUserSearch",props:{select:{type:Function}},setup(h){const _=h,t=V(),s=m(""),n=async(u,a)=>{const{data:l}=await w(async e=>await e.get(`users?search=${u}`));a(l.map(e=>({value:e.username})).filter(e=>e.value!==t.user.username))};return(u,a)=>{const l=k("el-autocomplete");return o(),B(l,{class:"mx-4 w-full",modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),"fetch-suggestions":n,placeholder:"Search users",onSelect:_.select,"prefix-icon":g(D)},null,8,["modelValue","onSelect","prefix-icon"])}}}),A=["infinite-scroll-disabled"],R=r("h2",{class:"my-2 mb-2 ml-4 text-lg text-gray-600 dark:text-neutral-100 font-bold"},"Chats",-1),H={class:"w-full pb-2"},J={class:"flex justify-between"},M={class:"block ml-2 font-semibold text-gray-800 dark:text-neutral-200"},G={class:"block ml-2 text-sm font-thin text-gray-600 dark:text-neutral-400"},I={class:"block ml-2 text-sm text-gray-500 dark:text-gray-400 truncate"},K={key:0,class:"mt-6 text-lg text-center text-gray-500 dark:text-neutral-300"},Q=b({__name:"List",setup(h){const _=E(),t=m([]),s=m(!1),n=m(!1),u=L(()=>s.value||n.value),a=async()=>{s.value=!0,await w(async e=>{const d=[].concat((await e.get(`/users/chats?limit=3&
      offset=${t.value.length}`)).data);t.value=t.value.concat(d),d.length<3&&(n.value=!0)},{serverErrorCb:e=>{e({message:"Network error, please try again later!",type:"error",showClose:!0,grouping:!0}),n.value=!0}}),s.value=!1},l=e=>{_.push({name:"chats",params:{slug:e.value}})};return(e,S)=>{const d=k("el-form-item"),C=v("infinite-scroll"),N=v("loading");return o(),i(y,null,[p(d,{size:"large"},{default:x(()=>[p(q,{onSelect:l})]),_:1}),$((o(),i("ul",{class:"h-[32rem]","infinite-scroll-disabled":u.value,"element-loading-text":"Loading..."},[R,(o(!0),i(y,null,z(t.value,c=>(o(),i("li",{key:c.id},[p(g(j),{to:{name:"chats",params:{slug:c.username}},class:"flex items-center px-3 py-2 text-sm transition duration-150 ease-in-out border-b dark:border-neutral-600 cursor-pointer hover:bg-blue-200 dark:hover:bg-zinc-800 focus:outline-none"},{default:x(()=>[r("div",H,[r("div",J,[r("span",M,f(c.username),1),r("span",G,f(g(U)(c.last_message_date).fromNow()),1)]),r("span",I,f(c.last_message),1)])]),_:2},1032,["to"])]))),128)),t.value.length===0?(o(),i("div",K,"No chats. Start conversation with someone!")):F("",!0)],8,A)),[[C,a],[N,s.value]])],64)}}});export{Q as default};
